<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Loan App - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</title>
  <meta name="description" content="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥">
  <meta name="theme-color" content="#111827">
  
  <!-- PWA Support -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Loan App">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üè¶</text></svg>">
  
  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- Styles -->
  <link rel="stylesheet" href="./css/styles.css">
  
<!-- App Initialization -->
  <script type="module">
  // ===== Auth dynamic import with fallbacks =====
  async function loadAuthModule() {
    const candidates = [
      '/js/auth-manager.js',
      './js/auth-manager.js',
      './auth-manager.js',
      '/auth-manager.js'
    ];
    for (const p of candidates) {
      try { const m = await import(p); console.log('[Auth] loaded from', p); return m; }
      catch (e) { console.warn('[Auth] not found at', p); }
    }
    return null;
  }

  document.addEventListener('DOMContentLoaded', async () => {
    console.log('App starting...');
    const auth = await loadAuthModule();
    if (auth) {
      const { AuthManager, updateAuthUI, setupLoginForm, setupLogoutButton } = auth;
      try { await AuthManager.initialize(); } catch(e){ console.error(e); }
      try { setupLoginForm && setupLoginForm(); } catch(e){ console.warn(e); }
      try { setupLogoutButton && setupLogoutButton(); } catch(e){ console.warn(e); }
      try { updateAuthUI && updateAuthUI(); } catch(e){ console.warn(e); }
      try { AuthManager && AuthManager.addAuthListener(() => updateAuthUI && updateAuthUI()); } catch(e){}
    } else {
      console.error('AuthManager module not found ‚Äî login UI will be static (GUEST).');
    }
    try { setupUI && setupUI(); } catch(e){}
    try { setupPWA && setupPWA(); } catch(e){}
  });

  // ===== Helpers (kept inside script; previously leaked to DOM) =====


  // --- Minimal helpers (restored) ---
  function updateConnectionStatus() {
    try {
      const statusEl = document.getElementById('connection-status');
      if (!statusEl) return;
      const online = navigator.onLine;
      statusEl.innerHTML = online ? 'üü¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : 'üî¥ ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå';
      statusEl.style.color = online ? '#2ecc71' : '#e74c3c';
      window.addEventListener('online', () => { statusEl.innerHTML = 'üü¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'; statusEl.style.color = '#2ecc71'; });
      window.addEventListener('offline', () => { statusEl.innerHTML = 'üî¥ ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå'; statusEl.style.color = '#e74c3c'; });
    } catch(e){}
  }

  function setupUI() {
    updateConnectionStatus();
  }

  function setupPWA() {
    let deferredPrompt = null;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      // optional: show install button if exists
      const btn = document.querySelector('[data-install-app]');
      if (btn) {
        btn.style.display = 'inline-flex';
        btn.addEventListener('click', async () => {
          try {
            await deferredPrompt.prompt();
            deferredPrompt = null;
            btn.style.display = 'none';
          } catch(e){}
        });
      }
    });
  }

  // lightweight toast
  window.showMessage = function(msg, type='info') {
    try {
      const box = document.createElement('div');
      const bg = type==='success' ? '#4CAF50' : type==='error' ? '#f44336' : '#2196F3';
      box.style.cssText = 'position:fixed;top:20px;right:20px;z-index:10000;padding:12px 16px;border-radius:8px;color:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.2)';
      box.style.backgroundColor = bg;
      box.textContent = msg;
      document.body.appendChild(box);
      setTimeout(()=>{ if (box.parentNode) box.parentNode.removeChild(box); }, 3000);
    } catch(e){ console.log(msg); }
  };
</script>

</head>

<body>
  <!-- Status Bar -->
  <div class="status-bar">
    <div>
      <span id="connection-status">üü° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
      <span style="margin-left: 20px;">
        ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: <strong id="user-email">‚Äî</strong>
      </span>
    </div>
    <div>
      <span id="role-badge" class="badge px-2 py-1 rounded-full text-xs font-semibold bg-gray-200">GUEST</span>
      <button id="btn-logout" class="btn outline hidden" style="margin-left: 10px;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
  </div>

  <div class="container">
    <!-- Hero Section -->
    <div class="hero">
      <h1>üè¶ Loan App</h1>
      <p>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥<br>
      ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì DSR, LTV ‡πÅ‡∏•‡∏∞‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</p>
    </div>

    <!-- Login Section -->
    <div class="card" id="login-form">
      <h3>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
      <p style="color: #666; margin-bottom: 20px;">
        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
      </p>
      
      <form>
        <div class="form-grid">
          <div>
            <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input id="email" type="email" placeholder="your@email.com" required>
          </div>
          <div>
            <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
            <input id="password" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
          </div>
          <div style="display: flex; gap: 10px;">
            <button class="btn" type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
            <button class="btn outline" type="button" onclick="showSignupForm()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
          </div>
        </div>
      </form>
      
      <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
        <p style="font-size: 0.9em; color: #999; margin: 0;">
          üí° <strong>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin:</strong> ‡πÉ‡∏ä‡πâ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "admin" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£<br>
          üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ Supabase Authentication
        </p>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="action-card">
        <h4>üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</h4>
        <p>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ</p>
        <a class="btn btn-full" href="./loan.html">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</a>
      </div>

      <div class="action-card">
        <h4>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</h4>
        <p>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå</p>
        <a class="btn btn-full outline" href="./admin.html">Admin Panel</a>
      </div>

      <div class="action-card">
        <h4>üìä ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h4>
        <p>‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</p>
        <button class="btn btn-full outline" onclick="showHistory()">‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
      </div>
    </div>

    <!-- Features Section -->
    <div class="features">
      <div class="feature">
        <span class="feature-icon">üí∞</span>
        <h3>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</h3>
        <p>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì DSR ‡πÅ‡∏•‡∏∞ LTV ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ï‡πà‡∏≤‡∏á‡πÜ</p>
      </div>

      <div class="feature">
        <span class="feature-icon">üè¶</span>
        <h3>‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</h3>
        <p>‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≥ 10+ ‡πÅ‡∏´‡πà‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
      </div>

      <div class="feature">
        <span class="feature-icon">üì±</span>
        <h3>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</h3>
        <p>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏° PWA ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô App ‡πÑ‡∏î‡πâ</p>
      </div>

      <div class="feature">
        <span class="feature-icon">‚ö°</span>
        <h3>Real-time Updates</h3>
        <p>‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö Real-time ‡∏ú‡πà‡∏≤‡∏ô Supabase</p>
      </div>

      <div class="feature">
        <span class="feature-icon">üîí</span>
        <h3>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h3>
        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ Supabase Auth ‡πÅ‡∏•‡∏∞ Row Level Security</p>
      </div>

      <div class="feature">
        <span class="feature-icon">üìà</span>
        <h3>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏•‡∏∂‡∏Å</h3>
        <p>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Total Cost of Ownership, Payment Schedule ‡πÅ‡∏•‡∏∞ Sensitivity Analysis</p>
      </div>
    </div>

    <!-- Info Section -->
    <div class="card" style="background: #f8f9fa; margin-top: 40px;">
      <h3 style="margin-top: 0;">üìã ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div>
          <strong>üè† ‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô (Mortgage)</strong>
          <p style="font-size: 0.9em; color: #666; margin: 5px 0;">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
        </div>
        <div>
          <strong>üîÑ ‡∏£‡∏µ‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå (Refinance)</strong>
          <p style="font-size: 0.9em; color: #666; margin: 5px 0;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</p>
        </div>
        <div>
          <strong>üë§ ‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</strong>
          <p style="font-size: 0.9em; color: #666; margin: 5px 0;">‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô</p>
        </div>
        <div>
          <strong>üè¢ ‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠ SME</strong>
          <p style="font-size: 0.9em; color: #666; margin: 5px 0;">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πá‡∏Å</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>&copy; 2024 Loan App - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</p>
    <p style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">
      Powered by Supabase ‚Ä¢ Made with ‚ù§Ô∏è in Thailand
    </p>
  </div>

  <!-- Scripts -->
  <script>
    function showSignupForm() {
      alert('‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ\n‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Admin ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡πâ');
    }
</script>
<script>
// ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢
function showMessage(message, type = 'info') {
  const messageBox = document.createElement('div');
  
  let backgroundColor = '#2196F3';
  if (type === 'error') backgroundColor = '#f44336';
  if (type === 'success') backgroundColor = '#4CAF50';
  if (type === 'warning') backgroundColor = '#ff9800';
  
  messageBox.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${backgroundColor};
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 10000;
    max-width: 350px;
    font-family: 'Segoe UI', sans-serif;
    font-size: 14px;
  `;
  
  messageBox.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <span>${message}</span>
      <button onclick="this.parentElement.parentElement.remove()" 
              style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 15px;">√ó</button>
    </div>
  `;
  
  document.body.appendChild(messageBox);
  
  setTimeout(() => {
    if (messageBox.parentElement) {
      messageBox.remove();
    }
  }, 5000);
}

// ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ PWA warning
window.addEventListener('beforeinstallprompt', function(e) {
  e.preventDefault();
  console.log('PWA install prompt blocked');
});

    function showHistory() {
      if (!document.getElementById('user-email').textContent || 
          document.getElementById('user-email').textContent === '‚Äî') {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥');
      } else {
        window.location.href = './loan.html#history';
      }
    }

    // Install PWA prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      deferredPrompt = e;
      showInstallButton();
    });

    function showInstallButton() {
      const installBtn = document.createElement('button');
      installBtn.textContent = 'üì± ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á App';
      installBtn.className = 'btn outline';
      installBtn.style.position = 'fixed';
      installBtn.style.bottom = '20px';
      installBtn.style.right = '20px';
      installBtn.style.zIndex = '1000';
      
      installBtn.addEventListener('click', () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('User accepted PWA install');
            }
            deferredPrompt = null;
            installBtn.remove();
          });
        }
      });
      
      document.body.appendChild(installBtn);
      
      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (installBtn.parentNode) {
          installBtn.remove();
        }
      }, 10000);
    }
  </script>
  
  <!-- Scripts -->
  <script>
    // Global message function
    function showMessage(message, type = 'info') {
      const messageBox = document.createElement('div');
      
      let backgroundColor = '#2196F3';
      if (type === 'error') backgroundColor = '#f44336';
      if (type === 'success') backgroundColor = '#4CAF50';
      if (type === 'warning') backgroundColor = '#ff9800';
      
      messageBox.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${backgroundColor};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 10000;
        max-width: 350px;
        font-family: 'Segoe UI', sans-serif;
        font-size: 14px;
      `;
      
      messageBox.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <span>${message}</span>
          <button onclick="this.parentElement.parentElement.remove()" 
                  style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 15px;">√ó</button>
        </div>
      `;
      
      document.body.appendChild(messageBox);
      
      setTimeout(() => {
        if (messageBox.parentElement) {
          messageBox.remove();
        }
      }, 5000);
    }

    function showSignupForm() {
      showMessage('‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ', 'info');
    }

    function showHistory() {
      const userEmail = document.getElementById('user-email').textContent;
      if (!userEmail || userEmail === '‚Äî') {
        showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥', 'warning');
      } else {
        window.location.href = './loan.html#history';
      }
    }

    // PWA handling
    window.addEventListener('beforeinstallprompt', function(e) {
      e.preventDefault();
      console.log('PWA install prompt handled');
    });

    // Page initialization
    document.addEventListener('DOMContentLoaded', function() {
      console.log('App starting...');
      
      // Update connection status
      const statusEl = document.getElementById('connection-status');
      if (statusEl) {
        statusEl.innerHTML = 'üü¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
        statusEl.style.color = '#28a745';
      }

      // Add loading states to buttons
      document.querySelectorAll('.btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          if (this.href && !this.href.includes('#')) {
            this.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
            this.disabled = true;
          }
        });
      });

      // Show welcome message
      setTimeout(() => {
        showMessage('‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Loan App!', 'success');
      }, 2000);
    });
  </script>
</body>
</html>
  
</body>
</html>