<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Console - Loan App</title>
  <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Loan App">

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Custom Styles -->
  <link rel="stylesheet" href="./css/styles.css" />

  <style>
    /* Admin specific styles */
    .admin-header {
      background: linear-gradient(135deg, #dc3545 0%, #6f42c1 100%);
      color: white;
      padding: 20px;
      margin-bottom: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
    }

    .admin-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 30px;
      border-left: 4px solid #dc3545;
    }

    .admin-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85em;
      margin-top: 15px;
    }

    .admin-table th {
      background: #f8f9fa;
      padding: 8px;
      text-align: left;
      border: 1px solid #dee2e6;
      font-weight: 600;
      color: #495057;
      white-space: nowrap;
    }

    .admin-table td {
      padding: 8px;
      border: 1px solid #dee2e6;
      vertical-align: top;
    }

    .admin-table tbody tr:hover {
      background-color: #f8f9fa;
    }

    .admin-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .admin-form input,
    .admin-form select,
    .admin-form textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ced4da;
      border-radius: 6px;
      font-size: 0.9em;
    }

    .admin-form textarea {
      min-height: 60px;
      resize: vertical;
    }

    .admin-form label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9em;
    }

    .btn-admin {
      background: #dc3545;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      transition: all 0.3s ease;
    }

    .btn-admin:hover {
      background: #c82333;
      transform: translateY(-1px);
    }

    .btn-admin.secondary {
      background: #6c757d;
    }

    .btn-admin.secondary:hover {
      background: #5a6268;
    }

    .btn-admin:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .action-buttons {
      display: flex;
      gap: 4px;
    }

    .btn-small {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.75em;
      transition: all 0.2s;
    }

    .btn-edit {
      background: #e3f2fd;
      color: #1976d2;
    }

    .btn-edit:hover {
      background: #bbdefb;
    }

    .btn-delete {
      background: #ffebee;
      color: #d32f2f;
    }

    .btn-delete:hover {
      background: #ffcdd2;
    }

    .status-badge {
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.75em;
      font-weight: bold;
    }

    .status-badge.active {
      background: #d4edda;
      color: #155724;
    }

    .status-badge.inactive {
      background: #f8d7da;
      color: #721c24;
    }

    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #dc3545;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 1000;
      max-width: 400px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .notification.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .notification.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .notification.info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .stat-number {
      font-size: 2em;
      font-weight: bold;
      color: #dc3545;
    }

    .stat-label {
      color: #6c757d;
      font-size: 0.9em;
      margin-top: 5px;
    }

    @media (max-width: 1200px) {
      .admin-table {
        font-size: 0.75em;
      }

      .admin-table th,
      .admin-table td {
        padding: 4px;
      }
    }

    @media (max-width: 768px) {
      .admin-form {
        grid-template-columns: 1fr;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .admin-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
    }
  </style>

  <script type="module">
    import AdminManager from './js/admin-manager-supabase.js';
    import './js/supabase-client.js';
    
    window.addEventListener('DOMContentLoaded', () => {
      const adminManager = new AdminManager();
      adminManager.initialize();
      
      // Export to global scope for button handlers
      window.adminManager = adminManager;
      
      // Add keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if (e.ctrlKey || e.metaKey) {
          switch (e.key) {
            case 'r':
              e.preventDefault();
              adminManager.refreshAll();
              break;
            case 's':
              e.preventDefault();
              adminManager.exportAllData();
              break;
          }
        }
      });
    });
  </script>
</head>

<body class="bg-gray-50">
  <!-- Header -->
  <div class="admin-header">
    <div class="flex justify-between items-center">
      <div class="flex items-center gap-4">
        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
          ‚öôÔ∏è
        </div>
        <div>
          <h1 class="text-2xl font-bold m-0">Admin Console</h1>
          <p class="m-0 opacity-90">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå</p>
        </div>
      </div>
      <div class="flex gap-3">
        <a class="btn-admin secondary" href="./index.html">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <a class="btn-admin" href="./loan.html">üßÆ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠</a>
      </div>
    </div>
  </div>

  <div class="container mx-auto px-4">
    <!-- Stats Dashboard -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number" id="stat-banks">‚Äî</div>
        <div class="stat-label">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="stat-promotions">‚Äî</div>
        <div class="stat-label">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="stat-rules">‚Äî</div>
        <div class="stat-label">‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="stat-calculations">‚Äî</div>
        <div class="stat-label">‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
      </div>
    </div>

    <!-- Promotions Management -->
    <div class="admin-card">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        üéØ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô
        <span class="text-sm font-normal text-gray-500">(‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î)</span>
      </h2>

      <!-- Promotions Table -->
      <div class="overflow-x-auto">
        <table class="admin-table">
          <thead>
            <tr>
              <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th>
              <th>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
              <th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              <th>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (bps)</th>
              <th>‡∏Ñ‡∏á‡∏ó‡∏µ‡πà (%)</th>
              <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</th>
              <th>‡∏õ‡∏µ1 (%)</th>
              <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ1</th>
              <th>‡∏õ‡∏µ2 (%)</th>
              <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ2</th>
              <th>‡∏õ‡∏µ3 (%)</th>
              <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ3</th>
              <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</th>
              <th>LTV ‡∏û‡∏¥‡πÄ‡∏®‡∏©</th>
              <th>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</th>
              <th>‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</th>
              <th>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ</th>
              <th>‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th>
            </tr>
          </thead>
          <tbody id="promo-body">
            <tr>
              <td colspan="19" class="text-center text-gray-500 py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Add Promotion Form -->
      <div class="admin-form">
        <div>
          <label>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label>
          <select id="new-bank">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</option>
          </select>
        </div>
        <div>
          <label>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
          <select id="new-product">
            <option>MORTGAGE</option>
            <option>REFINANCE</option>
            <option>PERSONAL</option>
            <option>SME</option>
          </select>
        </div>
        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</label>
          <input id="new-title" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏Å‡∏û‡∏¥‡πÄ‡∏®‡∏©" />
        </div>
        <div class="md:col-span-2">
          <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
          <textarea id="new-detail" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô..."></textarea>
        </div>
        <div>
          <label>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (basis points)</label>
          <input id="new-discount-bps" type="number" placeholder="25" />
        </div>
        <div>
          <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏õ‡∏µ‡πÅ‡∏£‡∏Å (%)</label>
          <input id="new-year1-rate" type="number" step="0.01" placeholder="3.99" />
        </div>
        <div>
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÅ‡∏£‡∏Å</label>
          <input id="new-year1-months" type="number" placeholder="12" />
        </div>
        <div>
          <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á (%)</label>
          <input id="new-year2-rate" type="number" step="0.01" placeholder="5.99" />
        </div>
        <div>
          <label>LTV Override (%)</label>
          <input id="new-ltv-override" type="number" step="0.01" placeholder="95" />
        </div>
        <div>
          <label>
            <input id="new-active" type="checkbox" checked />
            ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
          </label>
        </div>
        <div class="md:col-span-2">
          <button id="btn-promo-add" class="btn-admin mr-2">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</button>
          <button id="btn-promo-refresh" class="btn-admin secondary">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
          <button id="btn-promo-export" class="btn-admin secondary ml-2">üìä Export</button>
        </div>
      </div>
    </div>

    <!-- Bank Rules Management -->
    <div class="admin-card">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£
        <span class="text-sm font-normal text-gray-500">(DSR/LTV/‡∏≠‡∏≤‡∏¢‡∏∏/‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ/‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏á‡∏ä‡∏µ‡∏û)</span>
      </h2>

      <!-- Rules Table -->
      <div class="overflow-x-auto">
        <table class="admin-table">
          <thead>
            <tr>
              <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th>
              <th>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
              <th>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</th>
              <th>‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà</th>
              <th>DSR cap (%)</th>
              <th>LTV cap (%)</th>
              <th>‡∏ú‡πà‡∏≠‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏õ‡∏µ)</th>
              <th>‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏ö</th>
              <th>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</th>
              <th>‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏á‡∏ä‡∏µ‡∏û‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
              <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</th>
              <th>‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th>
            </tr>
          </thead>
          <tbody id="rules-body">
            <tr>
              <td colspan="12" class="text-center text-gray-500 py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Add Rule Form -->
      <div class="admin-form">
        <div>
          <label>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label>
          <select id="new-rule-bank">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</option>
          </select>
        </div>
        <div>
          <label>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
          <select id="new-rule-product">
            <option>MORTGAGE</option>
            <option>REFINANCE</option>
            <option>PERSONAL</option>
            <option>SME</option>
          </select>
        </div>
        <div>
          <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå</label>
          <select id="new-rule-prop">
            <option value="">‚Äî ‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‚Äî</option>
            <option>HOUSE</option>
            <option>TOWNHOME</option>
            <option>CONDO</option>
            <option>LAND+HOUSE</option>
          </select>
        </div>
        <div>
          <label>‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà</label>
          <select id="new-rule-home">
            <option value="">‚Äî ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ ‚Äî</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3+</option>
          </select>
        </div>
        <div>
          <label>DSR cap (%)</label>
          <input id="new-rule-dsr" type="number" step="0.01" placeholder="70" max="100" />
        </div>
        <div>
          <label>LTV cap (%)</label>
          <input id="new-rule-ltv" type="number" step="0.01" placeholder="90" max="100" />
        </div>
        <div>
          <label>‡∏ú‡πà‡∏≠‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏õ‡∏µ)</label>
          <input id="new-rule-years" type="number" placeholder="30" max="50" />
        </div>
        <div>
          <label>‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î</label>
          <input id="new-rule-age" type="number" placeholder="70" max="100" />
        </div>
        <div>
          <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (‡∏ö‡∏≤‡∏ó)</label>
          <input id="new-rule-income" type="number" placeholder="15000" />
        </div>
        <div>
          <label>‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏á‡∏ä‡∏µ‡∏û‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
          <input id="new-rule-mlc" type="number" placeholder="10000" />
        </div>
        <div>
          <label>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
          <input id="new-rule-priority" type="number" placeholder="1" min="1" />
        </div>
        <div class="md:col-span-2">
          <button id="btn-rules-add" class="btn-admin mr-2">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå</button>
          <button id="btn-rules-refresh" class="btn-admin secondary">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
          <button id="btn-rules-export" class="btn-admin secondary ml-2">üìä Export</button>
        </div>
      </div>
    </div>

    <!-- MRR Rates Management -->
    <div class="admin-card">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        üìà ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏ï‡∏£‡∏≤ MRR
        <span class="text-sm font-normal text-gray-500">(‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)</span>
      </h2>

      <!-- MRR Rates Table -->
      <div class="overflow-x-auto">
        <table class="admin-table">
          <thead>
            <tr>
              <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th>
              <th>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
              <th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤ MRR (%)</th>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•</th>
              <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
              <th>‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th>
            </tr>
          </thead>
          <tbody id="mrr-body">
            <tr>
              <td colspan="6" class="text-center text-gray-500 py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Add MRR Rate Form -->
      <div class="admin-form">
        <div>
          <label>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label>
          <select id="new-mrr-bank">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</option>
          </select>
        </div>
        <div>
          <label>‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
          <select id="new-mrr-product">
            <option>MORTGAGE</option>
            <option>REFINANCE</option>
            <option>PERSONAL</option>
            <option>SME</option>
          </select>
        </div>
        <div>
          <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤ MRR (%)</label>
          <input id="new-mrr-rate" type="number" step="0.01" placeholder="7.25" />
        </div>
        <div>
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏•</label>
          <input id="new-mrr-date" type="date" />
        </div>
        <div class="md:col-span-2">
          <button id="btn-mrr-add" class="btn-admin mr-2">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤ MRR</button>
          <button id="btn-mrr-refresh" class="btn-admin secondary">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
        </div>
      </div>
    </div>

    <!-- System Tools -->
    <div class="admin-card">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        üõ†Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <button class="btn-admin" onclick="adminManager?.exportAllData()">
          üíæ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </button>
        <button class="btn-admin secondary" onclick="adminManager?.clearCache()">
          üßπ ‡∏•‡πâ‡∏≤‡∏á Cache
        </button>
        <button class="btn-admin secondary" onclick="adminManager?.refreshAll()">
          üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </button>
        <button class="btn-admin secondary" onclick="showSystemInfo()">
          ‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö
        </button>
      </div>

      <!-- Activity Log -->
      <div style="margin-top: 20px;">
        <h4>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</h4>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-3">
          <div class="text-center p-3 bg-blue-50 rounded">
            <div class="text-2xl font-bold text-blue-600" id="stat-page-views">‚Äî</div>
            <div class="text-sm text-gray-600">Page Views</div>
          </div>
          <div class="text-center p-3 bg-green-50 rounded">
            <div class="text-2xl font-bold text-green-600" id="stat-calculations-24h">‚Äî</div>
            <div class="text-sm text-gray-600">‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</div>
          </div>
          <div class="text-center p-3 bg-yellow-50 rounded">
            <div class="text-2xl font-bold text-yellow-600" id="stat-active-users">‚Äî</div>
            <div class="text-sm text-gray-600">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</div>
          </div>
          <div class="text-center p-3 bg-purple-50 rounded">
            <div class="text-2xl font-bold text-purple-600" id="stat-errors">‚Äî</div>
            <div class="text-sm text-gray-600">Errors</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="admin-card">
      <h2 class="text-xl font-semibold mb-4">‚ö° Quick Actions</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="p-4 border border-gray-200 rounded-lg">
          <h4 class="font-semibold mb-2">üè¶ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h4>
          <div class="space-y-2">
            <input id="quick-bank-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£" class="w-full px-3 py-2 border rounded" />
            <input id="quick-bank-short" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠ (‡πÄ‡∏ä‡πà‡∏ô KBANK)" class="w-full px-3 py-2 border rounded" />
            <button class="btn-admin w-full" onclick="quickAddBank()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</button>
          </div>
        </div>

        <div class="p-4 border border-gray-200 rounded-lg">
          <h4 class="font-semibold mb-2">üéØ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡∏î‡πà‡∏ß‡∏ô</h4>
          <div class="space-y-2">
            <select id="quick-promo-bank" class="w-full px-3 py-2 border rounded">
              <option>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</option>
            </select>
            <input id="quick-promo-title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô" class="w-full px-3 py-2 border rounded" />
            <input id="quick-promo-rate" placeholder="‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ %" class="w-full px-3 py-2 border rounded" />
            <button class="btn-admin w-full" onclick="quickAddPromotion()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô</button>
          </div>
        </div>

        <div class="p-4 border border-gray-200 rounded-lg">
          <h4 class="font-semibold mb-2">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô</h4>
          <div class="space-y-2">
            <button class="btn-admin secondary w-full" onclick="generateDailyReport()">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</button>
            <button class="btn-admin secondary w-full" onclick="generateWeeklyReport()">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</button>
            <button class="btn-admin secondary w-full" onclick="generateMonthlyReport()">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="text-center py-8 text-gray-500">
    <p>&copy; 2024 Loan App Admin Console</p>
    <p class="text-sm mt-2">Powered by Supabase ‚Ä¢ Real-time Updates Enabled</p>
  </div>

  <!-- Scripts -->
  <script>
    // System info dialog
    function showSystemInfo() {
      alert(`üñ•Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö

üìä Database: Supabase PostgreSQL
üîê Authentication: Supabase Auth  
‚ö° Real-time: Supabase Realtime
üåê Frontend: HTML5 + ES6 Modules
üì± PWA: Service Worker Enabled

üîß Version: 2.0.0
üöÄ Status: Production Ready
üìà Uptime: 99.9%

Admin Features:
‚úÖ Live data management
‚úÖ Real-time updates  
‚úÖ Export/Import tools
‚úÖ Usage analytics
‚úÖ Error monitoring`);
    }

    // Quick actions
    function quickAddBank() {
      const name = document.getElementById('quick-bank-name')?.value;
      const shortName = document.getElementById('quick-bank-short')?.value;
      
      if (!name || !shortName) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      if (window.adminManager) {
        window.adminManager.addBank({ name, short_name: shortName, active: true });
      }
    }

    function quickAddPromotion() {
      const bankId = document.getElementById('quick-promo-bank')?.value;
      const title = document.getElementById('quick-promo-title')?.value;
      const rate = parseFloat(document.getElementById('quick-promo-rate')?.value);
      
      if (!bankId || !title || !rate) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      if (window.adminManager) {
        window.adminManager.addPromotion({
          bank_id: bankId,
          product_type: 'MORTGAGE',
          title,
          year1_rate: rate,
          active: true
        });
      }
    }

    function generateDailyReport() {
      const report = `üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ${new Date().toLocaleDateString('th-TH')}

üè¶ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${document.getElementById('stat-banks')?.textContent || '‚Äî'}
üéØ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ${document.getElementById('stat-promotions')?.textContent || '‚Äî'}  
üìã ‡∏Å‡∏é‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ: ${document.getElementById('stat-rules')?.textContent || '‚Äî'}
üßÆ ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ${document.getElementById('stat-calculations')?.textContent || '‚Äî'}

üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
- Page Views: ${document.getElementById('stat-page-views')?.textContent || '‚Äî'}
- ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì 24h: ${document.getElementById('stat-calculations-24h')?.textContent || '‚Äî'}
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå: ${document.getElementById('stat-active-users')?.textContent || '‚Äî'}
- Errors: ${document.getElementById('stat-errors')?.textContent || '‚Äî'}

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: Admin Console
‡πÄ‡∏ß‡∏•‡∏≤: ${new Date().toLocaleString('th-TH')}`;

      // Download as text file
      const blob = new Blob([report], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `daily-report-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function generateWeeklyReport() {
      alert('üöß ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏à‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ');
    }

    function generateMonthlyReport() {
      alert('üöß ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ');
    }

    // Auto-update stats every 30 seconds
    setInterval(() => {
      if (window.adminManager && window.adminManager.updateStats) {
        window.adminManager.updateStats();
      }
    }, 30000);

    // Set default date to today
    document.addEventListener('DOMContentLoaded', () => {
      const dateInput = document.getElementById('new-mrr-date');
      if (dateInput) {
        dateInput.value = new Date().toISOString().split('T')[0];
      }

      // Update stats periodically
      updateMockStats();
      setInterval(updateMockStats, 60000); // Update every minute
    });

    function updateMockStats() {
      // Mock statistics for demo
      const stats = {
        'stat-page-views': Math.floor(Math.random() * 1000) + 500,
        'stat-calculations-24h': Math.floor(Math.random() * 100) + 50,
        'stat-active-users': Math.floor(Math.random() * 20) + 5,
        'stat-errors': Math.floor(Math.random() * 3)
      };

      Object.entries(stats).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) {
          element.textContent = value.toLocaleString();
        }
      });
    }

    // Warning before leaving with unsaved changes
    let hasUnsavedChanges = false;

    document.addEventListener('input', (e) => {
      if (e.target.matches('input, select, textarea')) {
        hasUnsavedChanges = true;
      }
    });

    window.addEventListener('beforeunload', (e) => {
      if (hasUnsavedChanges) {
        e.preventDefault();
        e.returnValue = '';
      }
    });

    // Reset unsaved changes flag after successful save
    document.addEventListener('click', (e) => {
      if (e.target.matches('button[id*="add"], button[id*="update"]')) {
        setTimeout(() => {
          hasUnsavedChanges = false;
        }, 1000);
      }
    });
  </script>
</body>
</html>